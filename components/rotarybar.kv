#: import Factory kivy.factory.Factory
#: import Keypad components.keypad

<RotaryBar>:
  axis_name: "A"
  pos_format: app.angle_format

  divisions: app.divisions
  division_index: app.division_index
  division_offset: app.division_offset
  orientation: "vertical"
  size_hint_y: None
  height: 200

  BoxLayout:
    orientation: "horizontal"
    height: 100
    size_hint_y: None
    Button:
      text: root.axis_name
      width: 100
      size_hint_x: None
      font_size: 72
      font_style: "bold"
      on_release: Factory.Keypad().show(app.setter("current_position"))
    BoxLayout:
      orientation: "horizontal"
      BoxLayout:
        size_hint_x: 0.4
        orientation: "vertical"
        Label:
          text: "Current Angle"
          text_size: self.size
          size_hint_y: 0.2
          font_size: 16
          color: app.display_color
          halign: 'left'
          valign: 'bottom'
        Button:
          id: current_angle_button
          background_color: 0, 0, 0, 1
          size_hint_y: 0.8
          font_name: "fonts/Manrope-Bold.ttf"
          font_size: 48
          font_style: "bold"
          color: app.display_color
          text: root.pos_format.format(app.current_position)
          text_size: self.size
          halign: 'left'
          valign: 'bottom'
      BoxLayout:
        size_hint_x: 0.4
        orientation: "vertical"
        Label:
          text: "Desired Angle"
          text_size: self.size
          size_hint_y: 0.2
          font_size: 16
          color: app.display_color
          halign: 'left'
          valign: 'bottom'
        Button:
          id: desired_angle_button
          background_color: 0, 0, 0, 1
          size_hint_y: 0.8
          font_name: "fonts/Manrope-Bold.ttf"
          font_size: 48
          font_style: "bold"
          color: app.display_color
          text: root.pos_format.format(app.desired_position)
          text_size: self.size
          halign: 'left'
          valign: 'bottom'

    Button:
      text: "Set"
      font_size: 24
      font_style: "bold"
      background_color: [0.2, 0.8, 0.2, 1]
      width: 100
      size_hint_x: None
      on_release: Factory.Keypad().show(app.setter("desired_position"))
  BoxLayout:
    size_hint_y: None
    height: 100
    orientation: "horizontal"

    Button:
      font_name: "fonts/Font Awesome 6 Free-Solid-900.otf"
      text: "\uf068"
      font_size: 48
      font_style: "bold"
      background_color: [0.2, 0.8, 0.2, 1]
      width: 100
      size_hint_x: None
      on_release: root.division_index = (root.division_index - 1 + root.divisions) % root.divisions

    BoxLayout:
      size_hint_x: 0.5
      orientation: "vertical"
      Label:
        text: "Index"
        text_size: self.size
        size_hint_y: 0.2
        font_size: 16
        color: app.display_color
        halign: 'left'
        valign: 'bottom'
      Button:
        background_color: 0.1, 0.1, 0.1, 1
        size_hint_y: 0.8
        font_name: "fonts/Manrope-Bold.ttf"
        font_size: 48
        font_style: "bold"
        color: app.display_color
        text: str(int(root.division_index))
        text_size: self.size
        halign: 'left'
        on_release: Factory.Keypad().show(app.setter("division_index"))
    BoxLayout:
      size_hint_x: 0.5
      orientation: "vertical"
      Label:
        text: "Divisions"
        text_size: self.size
        size_hint_y: 0.2
        font_size: 16
        color: app.display_color
        halign: 'left'
        valign: 'bottom'
      Button:
        background_color: 0.1, 0.1, 0.1, 1
        size_hint_y: 0.8
        font_name: "fonts/Manrope-Bold.ttf"
        font_size: 48
        font_style: "bold"
        color: app.display_color
        text: str(int(root.divisions))
        text_size: self.size
        halign: 'left'
        on_release: Factory.Keypad().show(app.setter("divisions"))
    BoxLayout:
      size_hint_x: 0.5
      orientation: "vertical"
      Label:
        text: "Offset"
        text_size: self.size
        size_hint_y: 0.2
        font_size: 16
        color: app.display_color
        halign: 'left'
        valign: 'bottom'
      Button:
        background_color: 0.1, 0.1, 0.1, 1
        size_hint_y: 0.8
        font_name: "fonts/Manrope-Bold.ttf"
        font_size: 48
        font_style: "bold"
        color: app.display_color
        text: root.pos_format.format(root.division_offset)
        text_size: self.size
        halign: 'left'
        on_release: Factory.Keypad().show(app.setter("division_offset"))


    Button:
      font_name: "fonts/Font Awesome 6 Free-Solid-900.otf"
      text: "\u002b"
      font_size: 48
      font_style: "bold"
      background_color: [0.2, 0.8, 0.2, 1]
      width: 100
      size_hint_x: None
      on_release: root.division_index = (root.division_index+1) % root.divisions
#    Switch:
#      id: switch_me
#      title: "test"
#      text: "test"